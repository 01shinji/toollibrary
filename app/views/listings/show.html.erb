<div class="row">
 <div class="col-md-8 col-md-offset-2 col-xs-12">
   <!-- About -->
   <div class="row show-header">
    <div class="col-md-12">

     <h3>
       <b><%= @listing.listing_title %></b>
       <p>
         <span class="listing-category"><%= @listing.category1 %></span>
         <span class="listing-category"><%= @listing.category2 %></span>
         <span><%= @listing.listing_type %></span>
         <span>
           <% if @listing.Instant? %>即決可<% else @listing.Request? %>リクエスト<% end %>
         </span>
       </p>
     </h3>
     <div class="bottom">
       <ul>
         <li class="">
           <%= image_tag @listing.user.image, class: "img-circle avatar-large" %>
         </li>
         <li class="">
             <p>
               ホスト:
               <b>
               <% if (user_signed_in?)%>
                <%= @listing.user.fullname %>
               <% else %>
                <%= @listing.user.nickname %>
               <% end %>
               </b>
             </p>
             <p>
               <%= link_to "プロフィールを見る", @listing.user, class: "btn-blue" %>
             </p>
             <p>
               <span class="">
                <i class="fa fa-map-marker fa-lg"></i>
               </span>
               <span>
                <%= @listing.location %>
               </span>
             </p>
         </li>
       </ul>
     </div>

    </div>
   </div>

   <!-- Carousel -->
   <div class="row show-photo">
    <% if @photos.length > 0 %>
     <div id="myCarousel" class="carousel slide" data-ride="carousel" data-interval="false">
       <!-- Indicators -->
       <ol class="carousel-indicators">
         <% @photos.each do |photo| %>
             <li data-target="#myCarousel" data-slide-to="<%= photo.id %>"></li>
         <% end %>
       </ol>

       <!-- Wrapper for slides -->
       <div class="carousel-inner">
         <% @photos.each do |photo| %>
             <div class="item <%= 'active' if photo.id == @photos[0].id %>">
               <%= image_tag photo.image.url() %>
             </div>
         <% end %>
       </div>

       <!-- Left and right controls -->
       <a class="left carousel-control" href="#myCarousel" data-slide="prev">
         <span class="glyphicon glyphicon-chevron-left"></span>
         <span class="sr-only">前</span>
       </a>
       <a class="right carousel-control" href="#myCarousel" data-slide="next">
         <span class="glyphicon glyphicon-chevron-right"></span>
         <span class="sr-only">次</span>
       </a>
     </div>
    <% end %>
   </div>

   <!-- 価格 -->
   <div class="row" id="show-price">
    <div class="col-md-12">
     <h4>価格</h4>
      <p class="index-btn">
        <span class="form-check">
         <input class="form-check-input " type="radio" name="blankradio" id="blankradio1" value="option1 checked" >
        </span>
        １時間&nbsp;<%= @listing.price_hour %>円
      </p>
     <% if !@listing.price_day.blank? %>
      <p class="index-btn">
        <span class="form-check">
         <input class="form-check-input " type="radio" name="blankradio" id="blankradio1" value="option1" >
       </span>
        １日&nbsp;<%= @listing.price_day %>円
      </p>
     <% end %>
     <% if !@listing.price_month.blank? %>
      <p class="index-btn">
        <span class="form-check">
         <input class="form-check-input " type="radio" name="blankradio" id="blankradio1" value="option1" >
        </span>
        １ヶ月&nbsp;<%= @listing.price_month %>円
      </p>
     <% end %>
    </div>
   </div>

   <!-- 予約フォーム -->
   <div class="row" id="reservation">
     <div class="col-md-12 text-center">
       <div class="panel panel-default">
         <h3>予約フォーム</h3>
         <%= render 'reservations/form' %>
       </div>
     </div>
   </div>

   <hr class="dotted-hr" />

   <!-- 商品詳細 -->
   <div class="row">
    <div class="col-md-12">
     <h4>商品詳細</h4>
     <p><%= @listing.description %></p>
    </div>
   </div>

   <hr class="dotted-hr" />

   <!-- その他 -->
   <div class="row">
    <div class="col-md-3 col-sm-3 col-xs-3">
     <p>その他</p>
    </div>
    <div class="col-md-9 col-sm-9 col-xs-9">
     <div class="row">
         <ul class="amenities">
           <li class="<%= 'text-line-through' %>">シャワー,着替え</li>
           <li class="<%= 'text-line-through' %>">自転車</li>
           <li class="<%= 'text-line-through' %>">ウェットスーツ</li>
         </ul>
     </div>
   </div>
   </div>

   <hr class="dotted-hr" />

   <!-- レビュー -->
   <div class="row">
     <div class="col-md-12">
       <h4>
         <%= pluralize(@guest_reviews.count, "レビュー") %>
         <span id="average_rating"  class="host-stars"></span>
       </h4>

       <div class="">
         <div><%= render "reviews/guest_list" %></div>
       </div>
     </div>
   </div>



   <!-- GOOGLE MAP -->
   <div class="row show-map" >
     <div id="map" style="width: 100%; height: 400px"></div>
     <script type="text/javascript"
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA7ZRYgtCagsAWTqGbqxkpW09Y1i_ZYixI&libraries=places">
     </script>
     <script>
         function initialize() {
           var location = {lat: <%= @listing.latitude %>, lng: <%= @listing.longitude %>};


           var map = new google.maps.Map(document.getElementById('map'), {
             center: location,
             zoom: 14,
             // デフォルトのコントロールセット非表示
             disableDefaultUI: true,
             // デフォルトの情報ウィンドウ非表示
             clickableIcons: false
           });

           var marker = new google.maps.Marker({
             map: map
           });


           var infoWindow = new google.maps.InfoWindow({

             position: {lat: <%= @listing.latitude + 0.005 %>, lng: <%= @listing.longitude  %>},

             maxWidth: 200,
             content: '<div id="content"><b><%= @listing.listing_title %></b>の受け渡し場所(※予約成立後に詳細場所を通知)</div>'
           });

           var cityCircle = new google.maps.Circle({
             strokeWeight: 0,
             fillColor: '#04b4e4',
             fillOpacity: 0.5,
             map: map,
             center: location,
             radius: 500
           });

           infoWindow.open(map, marker);
         }

         google.maps.event.addDomListener(window, 'load', initialize);
     </script>
   </div>

   <!-- 近くのリスティング -->
   <% if @listing.nearbys.present? %>
   <h4>近くの出品中商品</h4>
   <div class="row nearby listings-list">
     <ul class="row-eq-height">
       <% for listing in @listing.nearbys(10) %>
        <li class="col-md-3 col-sm-3 col-xs-6 row-eq-height">
         <div class="listing-block">
           <div class="">
             <%= image_tag listing.cover_photo(:medium), class: 'img-responsive' %>
           </div>
           <div class="">
             <%= link_to listing.listing_title, listing %><br/>
             (ここから<%= listing.distance.round(3)*1000 %>メートル離れています)
           </div>
         </div>
        </li>
       <% end %>
     </ul>
   </div>
   <% end %>
 </div>
</div>



  <script>
   $('#average_rating').raty({
     path: '/assets',
     readOnly: true,
     score: <%= @listing.average_rating %>
   });
  </script>
